"use strict";"function"!=typeof Object.create&&(Object.create=function(obj){function F(){}return F.prototype=obj,new F}),function($,window,document,undefined){function supports(){return{ios:/iPad|iPhone|iPod/i.test(navigator.userAgent),android:/Android/i.test(navigator.userAgent),video:!!document.createElement("video").canPlayType}}var AmbientVideo={init:function(options,elem){var self=this;if(self.elem=elem,self.$elem=$(elem),self.options=$.extend({},$.fn.ambientVideo.defaults,self.$elem.data(),options),!self.options.videoSrc)throw new Error("You must include a `video-src` data-attribute");self.build()},build:function(){var self=this,showVideo=supports().video&&!supports().ios&&!supports().android;showVideo?self.$elem.waypoint(function(direction){self.insertVideo(),this.destroy()},{offset:self.options.videoOffset}):self.fallback()},insertVideo:function(){function checkReadyState(){4===self.video_dom.readyState?(self.$video_dom.addClass("ambient-video-loaded"),self.play()):setTimeout(checkReadyState,100)}var self=this;self.video_src_html='<video preload="metadata" muted><source src="'+self.options.videoSrc+'.webm" type="video/webm; codecs=vp8,vorbis"><source src="'+self.options.videoSrc+'.mp4" type="video/mp4; codecs=avc1.42E01E,mp4a.40.2"></video>',self.$elem.append(self.video_src_html),self.video_dom=self.$elem.find("video")[0],self.$video_dom=$(self.video_dom),self.$video_dom.prop({loop:self.options.videoLoop}),self.addClass(),self.load(),checkReadyState(),self.$video_dom.on("ended",function(){self.pause(),"function"==typeof self.options.onComplete&&self.options.onComplete.apply(self.elem,arguments)})},addClass:function(){var self=this;self.options.videoClass?self.$video_dom.addClass(self.options.videoClass):self.$video_dom.addClass($.fn.ambientVideo.defaults.videoClass)},load:function(){var self=this;self.video_dom.load()},play:function(){var self=this;self.video_dom.paused&&self.video_dom.play()},pause:function(){var self=this;self.video_dom.paused||(self.video_dom.pause(),self.is_video_playing=!1)},toggle:function(){var self=this;self.video_dom.paused?self.play():self.pause()},replay:function(){var self=this;self.video_dom.currentTime=0,self.video_dom.play()},fallback:function(){var fallback_img,self=this;self.options.videoFallback&&(fallback_img=$("<img />").attr("src",self.options.videoFallback).load(function(){$(this).remove(),self.$elem.css("background-image","url("+self.options.videoFallback+")")}))}};$.fn.ambientVideo=function(options){return this.each(function(){var video=Object.create(AmbientVideo);video.init(options,this),$.data(this,"ambientVideo",video)})},$.fn.ambientVideo.defaults={videoOffset:"100%",videoClass:"ambient-video-wrap",videoFallback:null,videoLoop:!1,videoSrc:null,onComplete:null}}(jQuery,window,document);