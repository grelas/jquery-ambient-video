/*! jquery-ambient-video - v0.1.0 - Greg LaSpina-2014-08-12 */
"function"!=typeof Object.create&&(Object.create=function(obj){function F(){}return F.prototype=obj,new F}),function($,window,document){"use strict";var AmbientVideo={init:function(options,elem){var self=this;self.elem=elem,self.$elem=$(elem),self.options=$.extend({},$.fn.ambientVideo.defaults,self.$elem.data(),options),"undefined"==typeof self.options.videoSrc,self.build()},build:function(){var self=this;!self.check().supports_video||null===self.options.videoSrc||self.check().is_iOS||self.check().is_Android?self.fallback():self.$elem.waypoint(function(){self.insertVideo()},{offset:self.options.videoOffset,triggerOnce:!0})},check:function(){return{supports_video:!!document.createElement("video").canPlayType,is_iOS:/iPad|iPhone|iPod/i.test(navigator.userAgent),is_Android:/Android/i.test(navigator.userAgent)}},insertVideo:function(){var self=this;self.video_src_html='<video preload muted><source src="'+self.options.videoSrc+'.mp4" type="video/mp4; codecs=avc1.42E01E,mp4a.40.2"><source src="'+self.options.videoSrc+'.webm" type="video/webm; codecs=vp8,vorbis"></video>',self.$elem.html(self.video_src_html),self.video_dom=self.$elem.find("video")[0],self.$video_dom=$(self.video_dom),self.$video_dom.prop({loop:self.options.videoLoop}),self.baseClass(),self.load(),self.play(),self.$video_dom.on("loadedmetadata",function(){self.$video_dom.addClass("ambient-video-loaded")}),self.video_dom.addEventListener("ended",function(){"function"==typeof self.options.onComplete&&self.options.onComplete.apply(self.elem,arguments)},!1)},baseClass:function(){var self=this;self.$video_dom.addClass(self.options.videoClass?self.options.videoClass:$.fn.ambientVideo.defaults.videoClass)},load:function(){var self=this;self.video_dom.load()},play:function(){var self=this;self.video_dom.paused&&self.video_dom.play()},pause:function(){var self=this;self.video_dom.paused||(self.video_dom.pause(),self.is_video_playing=!1)},toggle:function(){var self=this;self.video_dom.paused?self.play():self.pause()},replay:function(){var self=this;self.video_dom.currentTime=0,self.video_dom.play()},fallback:function(){var self=this;null!==self.options.videoFallback&&$.get(self.options.videoFallback).done(function(){self.$elem.css("background-image","url("+self.options.videoFallback+")")})}};$.fn.ambientVideo=function(options){return this.each(function(){var video=Object.create(AmbientVideo);video.init(options,this),$.data(this,"ambientVideo",video)})},$.fn.ambientVideo.defaults={videoOffset:"100%",videoClass:"ambient-video-wrap",videoFallback:null,videoLoop:!1,videoSrc:null,onComplete:null}}(jQuery,window,document);